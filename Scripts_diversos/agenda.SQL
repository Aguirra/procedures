SELECT A.DATA, A.COD_UNI, A.COD_SALA, PAA.COD_PRD, A.COD_PRO, A.COD_AGENDA, A.HORA_INI, A.HORA_FIN, PAA.DURACAO, A.ULT_SEQ_ENCAIXE, P.DESCRICAO, 
U.NOME_UNI, S.DESCRICAO NOME_SALA, 
(SELECT PR.NOME_PRO FROM FAPROCAD PR WHERE  PR.COD_PRO = A.COD_PRO) NOME_PRO, 
P.COD_AMB, 
DECODE((FAT_VERIFICAPRECO(P.CODIGO, P.TIPO_PRD, '', 
DECODE(NVL(A.TIPO_PAC_SUGER,'E'),'A','A','E'), '', '028', '03', '', 0, '', '', U.COD_UNI_FATURA, A.DATA)), 'S','S','N') AS POSSUI_PRECO, 
A.TIPO_PAC_SUGER FROM   IMAGNCAD A, PROCED_ATEND_AGEND PAA, FAPRDCAD P, AMUNICAD U, IMSALCAD S 
WHERE (S.COD_UNI = A.COD_UNI AND S.COD_SALA = A.COD_SALA) 
AND A.COD_AGENDA = PAA.COD_AGENDA 
AND P.CODIGO = PAA.COD_PRD 
AND U.COD_UNI = A.COD_UNI 
AND A.data >= '2012-05-03'  
AND A.tipo_atend = 'C'
AND S.cod_uni = '0001'  
AND PAA.cod_prd IN ('057509')  
AND (EXISTS (SELECT COD_ESP FROM   ESPEC_ATEND_AGENDA EAA WHERE  EAA.COD_AGENDA = A.COD_AGENDA AND COD_ESP IN ('OTO')) 
OR  NOT EXISTS (SELECT COD_ESP FROM   ESPEC_ATEND_AGENDA EAA WHERE  EAA.COD_AGENDA = A.COD_AGENDA))  
AND (EXISTS (SELECT COD_CONV FROM   CONV_ATEND_AGENDA CAA WHERE  CAA.COD_AGENDA = A.COD_AGENDA AND COD_CONV = '028') 
OR  NOT EXISTS (SELECT COD_CONV FROM   CONV_ATEND_AGENDA CAA WHERE  CAA.COD_AGENDA = A.COD_AGENDA)) 
ORDER BY A.DATA, A.HORA_INI, A.COD_SALA




select * from IMAGNCAD where Tipo_pac_suger is null and cod_sala = 'AM19' 
--and data = '2012-05-03' and t

--update imagncad set tipo_pac_suger = 'A' where cod_sala = 'AM19' and data = '2012-05-03' 